local java = dofile("java.knit")

local tools = java.toolchain("")
local rules = java.rules(tools)

return b{

    $ com/craftinginterpreters/lox/Scanner.class: com/craftinginterpreters/lox/TokenType.class com/craftinginterpreters/lox/Parser.class

    $ com/craftinginterpreters/lox/Token.class: com/craftinginterpreters/lox/TokenType.class

    $ com/craftinginterpreters/lox/Lox.class: com/craftinginterpreters/lox/TokenType.class com/craftinginterpreters/lox/Scanner.class com/craftinginterpreters/lox/Token.class com/craftinginterpreters/lox/Parser.class

    -- code gen

    $ com/craftinginterpreters/lox/Expr.java: com/craftinginterpreters/tool/GenerateAst.class
        java com.craftinginterpreters.tool.GenerateAst com/craftinginterpreters/lox

    $ com/craftinginterpreters/lox/Expr$$Binary.class: com/craftinginterpreters/lox/Expr.java
        $(tools.javac) com/craftinginterpreters/lox/Expr.java

    $ com/craftinginterpreters/lox/AstPrinter.class: com/craftinginterpreters/lox/Expr$$Binary.class

    -- parser

    $ com/craftinginterpreters/lox/Parser.class: com/craftinginterpreters/lox/TokenType.class com/craftinginterpreters/lox/Token.class com/craftinginterpreters/lox/Expr$$Binary.class


    rules
}
